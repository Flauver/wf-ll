# Rime schema
# encoding: utf-8

schema:
  schema_id: &schema LL
  name: ç¦»ä¹±
  version: release
  author:
    - è’
  dependencies:
    - &py PY
    - &bh xtroke
  description: |
    å‰ç¼€ç  + é«˜æ€§èƒ½å¤šé‡ç®€è¯
    ` é”®æ‹¼éŸ³åæŸ¥ï¼Œeåœ¨ã€Œ,ã€ï¼Œiåœ¨ã€Œ.ã€ã€‚symbolsç¬¦å·è¾“å…¥åŒç†ã€‚

switches:
  - name: chars_cand
    states: [ å­—å€™é€‰å…³, å­—å€™é€‰å¼€ ]
    reset: 1 
  - name: &div chaifen
    reset: 0
    states: [ éš, æ˜¾ ]
  - name: ascii_mode
    reset: 0
    states: [  ä¸­, è‹±  ]
  - name: full_shape
    states: [  åŠ, å…¨  ]
    reset: 0
  - name: ascii_punct
    states: ["ã€‚", "ï¼"]
    reset: 0

engine:
  processors:
    - lua_processor@*ll.chars_cand
    - ascii_composer
    - recognizer
    - key_binder
    - lua_processor@*moran.moran_pin*pin_processor
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - affix_segmentor@PY_lookup
    - affix_segmentor@xtroke_lookup
    - affix_segmentor@reverse_lookup
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - history_translator
    - script_translator@PY_lookup
    - table_translator@xtroke_lookup
    - table_translator@fixed
    - table_translator
    - table_translator@zaoci
    - lua_translator@*ll.speed_stats
    - lua_translator@*moran.moran_pin*panacea_translator
    - history_translator@historyX
  filters: 
    - lua_filter@*moran.moran_pin*pin_filter
    - simplifier@chaifen
    - reverse_lookup_filter@reverse_lookup
    - uniquifier 

speller:
  alphabet: qwrtyuopasdfghjkl;'zxcvbnm,./]
  delimiter: "`"
  #max_code_length: 4
  #initials: qwrtyuopasdfghjkl;zxcvbnm,./]
  #auto_clear: max_length
  auto_select: true
  #auto_select_unique_candidate: true
  #auto_select_pattern: ^w.$|^.*[wruo]$
  #delimiter: []

# å›ºå®šè¯åº“è¯çš„æƒé‡ï¼Œé˜²æ­¢è‡ªåŠ¨è°ƒé¢‘
fixed:
  __include: translator
  enable_sentence: false
  enable_user_dict: false
  initial_quality: 1000000

translator:
  dictionary: *schema
  prism: *schema
  enable_completion: false
  enable_sentence: false
  enable_user_dict: true
  enable_encoder: true
  encode_commit_history: false
  max_phrase_length: 4
  always_show_comments: true
  preedit_format: []
  comment_format:
    - "xform/^~/ /"

zaoci:
  __include: translator
  initial_quality: 0
  enable_sentence: true
  enable_user_dict: true
  prefix: "`"
  tips: "ã€”ç”¨æˆ·é€ è©ã€•"
  tag: zaoci

# æ‹¼éŸ³åæŸ¥
reverse_lookup:
  tag: reverse_lookup
  dictionary: *schema
  prefix: "`"    # åæŸ¥å¼•å¯¼ç¬¦ã€Œ`ã€
  tips: ã€åæŸ¥ï¼šæ‹¼éŸ³+è¶…çº§ç¬”ç”»ã€‘
  closing_tips: ã€åæŸ¥å…³é—­ã€‘
  tags: [ PY_lookup, xtroke_lookup ]
  extra_tags:
    - PY_lookup
    - xtroke_lookup
  comment_format: []

PY_lookup:
  tag: PY_lookup
  dictionary: *py
  enable_user_dict: false
  prefix: '`P'
  tips: ã€æ‹¼éŸ³åæŸ¥ã€‘
  closing_tips: ã€åæŸ¥å…³é—­ã€‘
  initial_quality: 0.2
  preedit_format:
    - xform/^(.*?),/$1e/
    - xform/^(.*)\./$1i/

xtroke_lookup:
  tag: xtroke_lookup
  dictionary: *bh
  prism: xtroke
  enable_user_dict: false
  prefix: '`X'
  tips: ã€è¶…çº§ç¬”ç”»åæŸ¥ã€‘
  closing_tips: ã€åæŸ¥å…³é—­ã€‘
  initial_quality: 0.5
  preedit_format:
    - 'xform/^([hspnz]+)$/$1\tï¼ˆ\U$1\Eï¼‰/'
    - xlit/HSPNZ/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/
  comment_format: []

historyX:
  input: 'wj'
  size: 10
  initial_quality: 10

chaifen:
  opencc_config: ll_chaifen.json
  option_name: *div
  show_in_comment: true 
  comment_format:     
    - "xform/&nbsp;/ /"
  tags:
    - abc
    - reverse_lookup
  tips: all # all char

key_binder:
  bindings:
    - {accept: "e", send: "A", when: has_menu} 
    - {accept: "i", send: "B", when: has_menu} 
    - {accept: "[", send: "C", when: has_menu} 
    - {accept: Tab, send: "C", when: has_menu} 
    - {accept: 1, send: "0", when: has_menu} 
    - {accept: 4, send: "7", when: has_menu} 
    #- {accept: "Control+Control_L", send: "8", when: has_menu} 
    - {accept: "Shift+Shift_L", send: "9", when: has_menu} 
    - {accept: minus, send: Page_Up, when: has_menu} 
    - {accept: equal, send: Page_Down, when: has_menu} 
    #- {accept: Return, send: Escape, when: composing}    # å›è½¦æ¸…å±
    - {accept: "Control+Shift+O", toggle: full_shape, when: always} 
    - {accept: "Control+Shift+E", toggle: ascii_mode, when: always} 
    - {accept: "Control+Shift+N", toggle: ascii_mode, when: always} 
    - {accept: "Control+Shift+.", toggle: ascii_punct, when: always}
    - {accept: "Control+i", toggle: chaifen, when: always}

menu:
  alternative_select_labels: [ '_', 'e', 'i', 'T|[', '2', '3', '4|7', 'C|8', 'S|9', '1|0']
  alternative_select_keys: "_ABC237890"
  page_size: 10

punctuator:
  half_shape:
    ',' : []
    '.' : []
    '<' : [ ã€Š, ã€ˆ, Â«, â€¹, âŸ¨, Ë‚, Ë± ]
    '>' : [ ã€‹, ã€‰, Â», â€º, âŸ©, Ëƒ, Ë² ]
    '/' : []
    '?' : { commit: ï¼Ÿ }
    ';' : []
    ':' : { commit: ï¼š }
    '''': { commit: ã€‚ }
    '"' : { pair: [ 'â€œ', 'â€' ] }
    '\' : { commit: ã€ }
    '|' : [ Â·, ãƒ», '|', ï½œ, 'Â§', 'Â¦', 'â€–' ]
    '`' : [ '`', â€µ, â€¶, â€·, â€², â€³, â€´, â— ]
    '~' : [ '~', ï½, Ëœ, Ë·, â¸¯, â‰ˆ, â‰‹, â‰ƒ, â‰…, â‰‡, âˆ½, â‹, â‰Œ, ï¹, ï¹‹, ï¹Œ, ï¸´ ]
    '!' : { commit: ï¼ }
    '@' : [ '@', Â©, Â®, â„— ]
    '#' : [ '#', â„– ]
    '%' : [ '%', ï¼…, 'Â°', 'â„ƒ', â€°, â€±, â„‰, â„…, â„†, â„€, â„, â… ]
    '$' : [ ï¿¥, '$', 'â‚¬', 'Â£', 'Â¥', 'Â¢', 'Â¤', â‚© ]
    '^' : { commit: â€¦â€¦ }
    '&' : '&'
    '*' : [ '*', ï¼Š, Â·, ãƒ», Ã—, â€», â‚, â‚, â˜®, â˜¯, â˜£ ]
    '(' : ï¼ˆ
    ')' : ï¼‰
    '-' : '-'
    '_' : â€”â€”
    '+' : '+'
    '=' : [ '=', ã€…, ã€ƒ ]
    '[' : [ ã€Œ, ã€, ã€”, ï¼», ã€š, ã€˜ ]
    ']' : [ ã€, ã€‘, ã€•, ï¼½, ã€›, ã€™ ]
    '{' : [ ã€, ã€–, ï½› ]
    '}' : [ ã€, ã€—, ï½ ]
  half_shape:
    ',' : []
    '.' : []
    '<' : [ ã€Š, ã€ˆ, Â«, â€¹, âŸ¨, Ë‚, Ë± ]
    '>' : [ ã€‹, ã€‰, Â», â€º, âŸ©, Ëƒ, Ë² ]
    '/' : []
    '?' : { commit: ï¼Ÿ }
    ';' : []
    ':' : { commit: ï¼š }
    '''': { commit: ã€‚ }
    '"' : { pair: [ 'â€œ', 'â€' ] }
    '\' : [ ã€, '\', ï¼¼ ]
    '|' : [ Â·, ãƒ», '|', ï½œ, 'Â§', 'Â¦', 'â€–', ï¸´ ]
    '`' : [ '`', â€µ, â€¶, â€·, â€², â€³, â€´, â— ]
    '~' : [ '~', ï½, Ëœ, Ë·, â¸¯, â‰ˆ, â‰‹, â‰ƒ, â‰…, â‰‡, âˆ½, â‹, â‰Œ, ï¹, ï¹‹, ï¹Œ, ï¸´ ]
    '!' : { commit: ï¼ }
    '@' : [ '@', Â©, Â®, â„— ]
    '#' : [ '#', â„– ]
    '%' : [ '%', ï¼…, 'Â°', 'â„ƒ', â€°, â€±, â„‰, â„…, â„†, â„€, â„, â… ]
    '$' : [ ï¿¥, '$', 'â‚¬', 'Â£', 'Â¥', 'Â¢', 'Â¤', â‚© ]
    '^' : { commit: â€¦â€¦ }
    '&' : '&'
    '*' : [ '*', ï¼Š, Â·, ãƒ», Ã—, â€», â‚, â‚, â˜®, â˜¯, â˜£ ]
    '(' : ï¼ˆ
    ')' : ï¼‰
    '-' : '-'
    '_' : â€”â€”
    '+' : '+'
    '=' : [ '=', ã€…, ã€ƒ ]
    '[' : [ ã€Œ, ã€, ã€”, ï¼», ã€š, ã€˜ ]
    ']' : [ ã€, ã€‘, ã€•, ï¼½, ã€›, ã€™ ]
    '{' : [ ã€, ã€–, ï½› ]
    '}' : [ ã€, ã€—, ï½ ]
  symbols:
    __include: symbols:/punctuator/symbols

moran:
  # ã€Œç½®é ‚ã€åŠŸèƒ½ç›¸é—œè¨­ç½®
  # è¼¸å…¥æ™‚é€šéå¿«æ·éµ Ctrl+t å¯ä»¥å°‡é«˜äº®é¡¯ç¤ºçš„å€™é¸ç½®é ‚ï¼Œè¢«ç½®é ‚çš„å€™é¸ä½ç½®å›ºå®šï¼Œä¸å†åƒèˆ‡èª¿é »
  # å°åŒä¸€è¼¸å…¥ç¢¼æœ€é«˜æ”¯æŒ8å€‹ç½®é ‚è©ï¼Œç•¶å˜—è©¦ç½®é ‚ç¬¬9å€‹è©æ™‚ï¼Œæœ€æ—©è¢«ç½®é ‚çš„è©å°‡æœƒå¤±æ•ˆ
  pin:
    # ã€Œç½®é ‚ã€åŠŸèƒ½é–‹é—œ
    enable: true
    # ç½®é ‚è©æç¤ºç¬¦
    indicator: "ğŸ“Œ"
    # ã€Œè¬éˆè—¥ã€åŠ è©åŠŸèƒ½
    # é€šéè¼¸å…¥ ã€Œç·¨ç¢¼Aã€//ã€Œç·¨ç¢¼Bã€ å¯¦ç¾é€ è©åŠŸèƒ½ï¼Œç·¨ç¢¼Aæ˜¯é€™å€‹æ–°è©çš„æ–°ç·¨ç¢¼ ç·¨ç¢¼Bæ˜¯ç›®å‰å¯ä»¥æ‰“å‡ºè©²è©çš„ç·¨ç¢¼
    # ä¾‹å¦‚ è¼¸å…¥ tnfb ä¸èƒ½å¾—åˆ°ã€Œé ­è…¦é¢¨æš´ã€é€™ä¸€å€™é¸ï¼Œ æ­¤æ™‚æˆ‘å€‘å¯ä»¥è¼¸å…¥ tnfb//tbnkfgbk æŒ‰ä¸‹ç©ºæ ¼ è®“ã€Œé ­è…¦é¢¨æš´ã€å€™é¸ä¸Šå±ï¼Œä¸Šå±çš„è©æœƒè¢«åŠ å…¥ç”¨æˆ¶è©åº«ä¸­ï¼Œä¹‹å¾Œæˆ‘å€‘å¯ä»¥ç”¨ tnfb ä¾†å¾—åˆ°ã€Œé ­è…¦é¢¨æš´ã€é€™ä¸€å€™é¸äº†
    # é€ å‡ºçš„è©èˆ‡ç½®é ‚è©æ˜¯ç­‰åŒçš„
    panacea:
      # åŠ è©ç‹€æ…‹æç¤º
      prompt: "ã€”åŠ è©ã€•"
      # åŠ è©ä¸­ç¶´å¼•å°ç¬¦
      infix: "]"
      # è‡ªç”±åŠ è©æ¨¡å¼é–‹é—œï¼Œé–‹å•“æ­¤æ¨¡å¼å¾Œï¼Œè¼¸å…¥ã€Œç·¨ç¢¼Aã€//ä¸¦ç©ºæ ¼ä¸Šå±å¾Œæœƒé€²å…¥åŠ è©ç‹€æ…‹ï¼Œæ­¤æ™‚å¯ä»¥é€£çºŒåœ°ã€ä¸å—æŸç¸›åœ°è¼¸å…¥ï¼Œå†æ¬¡æŒ‰ä¸‹x//ç©ºæ ¼é€€å‡ºåŠ è©ç‹€æ…‹ï¼ŒæœŸé–“è¼¸å…¥çš„å…§å®¹å°‡æœƒè¢«è¨˜éŒ„çˆ²ã€Œç·¨ç¢¼Aã€çš„æ–°ç½®é ‚è©
      # æ­¤æ¨¡å¼é©åˆé€ ä¸€äº›æ··åˆè©ï¼Œå¦‚ã€ŒA4ç´™ã€ã€ã€ŒKOS-MOSã€ç­‰
      freestyle: true

recognizer:
  #import_preset: default
  patterns:
    reverse_lookup: "^`([qwrtyuopasdfghjklzxcvbnm,.]+?)*$"
    PY_lookup: "^`P([qwrtyuopasdfghjklzxcvbnm,.]+'?)*$"
    xtroke_lookup: "^`X([hspnz]+'?)*$"
    zaoci: "^[qwrtyuopasdfghjklzxcvbnm;,./]*`[qwrtyuopasdfghjklzxcvbnm;,./`]*$"
    roots: "][qwrtyuopasdfghjklzxcvbnm;,/]*"
    punct: '^\|([QWRTYUOPASDFGHJKLZXCVBNM<>qwrtyuopasdfghjklzxcvbnm,.]+)$'
