# Rime schema
# encoding: utf-8

schema:
  schema_id: &schema LL
  name: ç¦»ä¹±
  version: release
  author:
    - è’
  dependencies:
    - &py PY
    - &bh xtroke
    - &cf LL_chaifen
    - &ll LL_linglong
  description: |
    å‰ç¼€ç  + é«˜æ€§èƒ½å¤šé‡ç®€è¯
    ` é”®æ‹¼éŸ³åæŸ¥ï¼Œeåœ¨ã€Œ,ã€ï¼Œiåœ¨ã€Œ.ã€ã€‚symbolsç¬¦å·è¾“å…¥åŒç†ã€‚

switches:
  - name: buffered
    states: [ç»“æŸé€ è¯, å¼€å§‹é€ è¯]
    reset: 0
  - name: charset_filter
    states: [ å¤§å­—é›†, å¸¸ç”¨å­— ]
    reset: 1
  - name: chars_cand
    states: [ å­—å€™é€‰å…³, å­—å€™é€‰å¼€ ]
    reset: 1 
  - options:
      - ll_spelling.off
      - ll_spelling.lv1
      - ll_spelling.lv2
      - ll_spelling.lv3
    states: [ æ— æ³¨è§£, ä¸€é‡æ³¨è§£, äºŒé‡æ³¨è§£, å¤šé‡æ³¨è§£ ]
    reset: 0
  - name: ascii_mode
    reset: 0
    states: [  ä¸­, è‹±  ]
  - name: full_shape
    states: [  åŠ, å…¨  ]
    reset: 0
  - name: ascii_punct
    states: [ "ã€‚", "ï¼" ]
    reset: 0

engine:
  processors:
    - lua_processor@*ll.chars_cand
    - ascii_composer
    - recognizer
    - lua_processor@*ll.div_spelling*processor
    - key_binder
    - lua_processor@*ll.popping
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - affix_segmentor@PY_lookup
    - affix_segmentor@xtroke_lookup
    - affix_segmentor@reverse_lookup
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - history_translator
    - script_translator@PY_lookup
    - table_translator@xtroke_lookup
    - table_translator@fixed
    - table_translator@custom_phrase
    - table_translator
    - lua_translator@*ll.speed_stats
    - history_translator@historyX
  filters: 
    - lua_filter@*ll.charset_filter
    - lua_filter@*ll.fix_filter
    - reverse_lookup_filter@reverse_lookup
    - lua_filter@*ll.div_spelling*filter
    - uniquifier 

speller:
  alphabet: qwrtyuopasdfghjkl;'zxcvbnm,./]
  delimiter: "`"
  auto_select: true

fixed:
  __include: translator
  dictionary: *ll
  prism: *ll
  enable_user_dict: false
  enable_sentence: false
  initial_quality: 100000

custom_phrase: # è‡ªå®šç¾©çŸ­èª
  dictionary: ""
  user_dict: LL_custom_phrases
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 10000

translator:
  dictionary: *schema
  prism: *schema
  enable_completion: false
  enable_sentence: false
  enable_user_dict: true
  enable_encoder: true
  encode_commit_history: false
  max_phrase_length: 4
  always_show_comments: true
  initial_quality: 1000
  preedit_format: []
  comment_format:
    - "xform/^~/ /"

# æ‹¼éŸ³åæŸ¥
reverse_lookup:
  tag: reverse_lookup
  dictionary: *schema
  prefix: "`"    # åæŸ¥å¼•å¯¼ç¬¦ã€Œ`ã€
  tips: ã€åæŸ¥ï¼šæ‹¼éŸ³+è¶…çº§ç¬”ç”»ã€‘
  closing_tips: ã€åæŸ¥å…³é—­ã€‘
  tags: [ PY_lookup, xtroke_lookup ]
  extra_tags:
    - PY_lookup
    - xtroke_lookup
  comment_format: 
    - xform/\]/æ ¹/

PY_lookup:
  tag: PY_lookup
  dictionary: *py
  enable_user_dict: false
  prefix: '`P'
  tips: ã€æ‹¼éŸ³åæŸ¥ã€‘
  closing_tips: ã€åæŸ¥å…³é—­ã€‘
  initial_quality: 0.2
  preedit_format:
    - xform/,/e/
    - xform/\./i/

xtroke_lookup:
  tag: xtroke_lookup
  dictionary: *bh
  prism: xtroke
  enable_user_dict: false
  prefix: '`X'
  tips: ã€è¶…çº§ç¬”ç”»åæŸ¥ã€‘
  closing_tips: ã€åæŸ¥å…³é—­ã€‘
  initial_quality: 0.5
  preedit_format:
    - 'xform/^([hspnz]+)$/$1\tï¼ˆ\U$1\Eï¼‰/'
    - xlit/HSPNZ/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/
  comment_format: []

historyX:
  input: 'wj'
  size: 10
  initial_quality: 10

ll:
  code: *schema
  tags: [ abc ]
  # emoji examples: âš¡ï¸ ğŸ‘¤ ğŸ” ğŸ”¥ âœ¨ â¬†ï¸ ğŸ«µğŸ» ğŸ—² ğŸ¯ ğŸ“Œ ğŸ’¡ ğŸŒŸ
  quick_code_indicator: "ğŸŒŸ"
  custom_phrases_indicator: "ğŸ’¡"
  spelling:
    schema: *cf
    cycle_key: "Shift+Control+C"
    switch_key: "Control+c"
    phrase: 1

key_binder:
  bindings:
    - {accept: "e", send: "A", when: has_menu}
    - {accept: "i", send: "B", when: has_menu}
    - {accept: "[", send: "C", when: has_menu}
    - {accept: Tab, send: "C", when: has_menu}
    - {accept: 1, send: "0", when: has_menu}
    - {accept: 4, send: "7", when: has_menu}
    #- {accept: "Control+Control_L", send: "8", when: has_menu}
    - {accept: "Shift+Shift_L", send: "9", when: has_menu}
    - {accept: i, toggle: buffered, when: always}
    - {accept: "Control+k", send: "Shift+Delete", when: has_menu}
    - {accept: "5", toggle: charset_filter, when: has_menu}
    - {accept: minus, send: Page_Up, when: has_menu}
    - {accept: equal, send: Page_Down, when: has_menu}
    #- {accept: Return, send: Escape, when: composing}    # å›è½¦æ¸…å±
    - {accept: "Control+Shift+O", toggle: full_shape, when: always}
    - {accept: "Control+Shift+N", toggle: ascii_mode, when: always}

menu:
  alternative_select_labels: [ '_', 'e', 'i', 'T|[', '2', '3', '4|7', 'C|8', 'S|9', '1|0']
  alternative_select_keys: "_ABC237890"
  page_size: 10

punctuator:
  half_shape:
    ',' : []
    '.' : []
    '<' : [ ã€Š, ã€ˆ, Â«, â€¹, âŸ¨, Ë‚, Ë± ]
    '>' : [ ã€‹, ã€‰, Â», â€º, âŸ©, Ëƒ, Ë² ]
    '/' : []
    '?' : { commit: ï¼Ÿ }
    ';' : []
    ':' : { commit: ï¼š }
    '''': { commit: ã€‚ }
    '"' : { pair: [ 'â€œ', 'â€' ] }
    '\' : { commit: ã€ }
    '|' : [ Â·, ãƒ», '|', ï½œ, 'Â§', 'Â¦', 'â€–' ]
    '`' : [ '`', â€µ, â€¶, â€·, â€², â€³, â€´, â— ]
    '~' : [ '~', ï½, Ëœ, Ë·, â¸¯, â‰ˆ, â‰‹, â‰ƒ, â‰…, â‰‡, âˆ½, â‹, â‰Œ, ï¹, ï¹‹, ï¹Œ, ï¸´ ]
    '!' : { commit: ï¼ }
    '@' : [ '@', Â©, Â®, â„— ]
    '#' : [ '#', â„– ]
    '%' : [ '%', ï¼…, 'Â°', 'â„ƒ', â€°, â€±, â„‰, â„…, â„†, â„€, â„, â… ]
    '$' : [ ï¿¥, '$', 'â‚¬', 'Â£', 'Â¥', 'Â¢', 'Â¤', â‚© ]
    '^' : { commit: â€¦â€¦ }
    '&' : '&'
    '*' : [ '*', ï¼Š, Â·, ãƒ», Ã—, â€», â‚, â‚, â˜®, â˜¯, â˜£ ]
    '(' : ï¼ˆ
    ')' : ï¼‰
    '-' : '-'
    '_' : â€”â€”
    '+' : '+'
    '=' : [ '=', ã€…, ã€ƒ ]
    '[' : [ ã€Œ, ã€, ã€”, ï¼», ã€š, ã€˜ ]
    ']' : [ ã€, ã€‘, ã€•, ï¼½, ã€›, ã€™ ]
    '{' : [ ã€, ã€–, ï½› ]
    '}' : [ ã€, ã€—, ï½ ]
  full_shape:
    ',' : []
    '.' : []
    '<' : [ ã€Š, ã€ˆ, Â«, â€¹, âŸ¨, Ë‚, Ë± ]
    '>' : [ ã€‹, ã€‰, Â», â€º, âŸ©, Ëƒ, Ë² ]
    '/' : []
    '?' : { commit: ï¼Ÿ }
    ';' : []
    ':' : { commit: ï¼š }
    '''': { commit: ã€‚ }
    '"' : { pair: [ 'â€œ', 'â€' ] }
    '\' : [ ã€, '\', ï¼¼ ]
    '|' : [ Â·, ãƒ», '|', ï½œ, 'Â§', 'Â¦', 'â€–', ï¸´ ]
    '`' : [ '`', â€µ, â€¶, â€·, â€², â€³, â€´, â— ]
    '~' : [ '~', ï½, Ëœ, Ë·, â¸¯, â‰ˆ, â‰‹, â‰ƒ, â‰…, â‰‡, âˆ½, â‹, â‰Œ, ï¹, ï¹‹, ï¹Œ, ï¸´ ]
    '!' : { commit: ï¼ }
    '@' : [ '@', Â©, Â®, â„— ]
    '#' : [ '#', â„– ]
    '%' : [ '%', ï¼…, 'Â°', 'â„ƒ', â€°, â€±, â„‰, â„…, â„†, â„€, â„, â… ]
    '$' : [ ï¿¥, '$', 'â‚¬', 'Â£', 'Â¥', 'Â¢', 'Â¤', â‚© ]
    '^' : { commit: â€¦â€¦ }
    '&' : '&'
    '*' : [ '*', ï¼Š, Â·, ãƒ», Ã—, â€», â‚, â‚, â˜®, â˜¯, â˜£ ]
    '(' : ï¼ˆ
    ')' : ï¼‰
    '-' : '-'
    '_' : â€”â€”
    '+' : '+'
    '=' : [ '=', ã€…, ã€ƒ ]
    '[' : [ ã€Œ, ã€, ã€”, ï¼», ã€š, ã€˜ ]
    ']' : [ ã€, ã€‘, ã€•, ï¼½, ã€›, ã€™ ]
    '{' : [ ã€, ã€–, ï½› ]
    '}' : [ ã€, ã€—, ï½ ]
  symbols:
    __include: symbols:/punctuator/symbols

recognizer:
  #import_preset: default
  patterns:
    reverse_lookup: "^`([qwrtyuopasdfghjklzxcvbnm,.]+?)*$"
    PY_lookup: "^`P([qwrtyuopasdfghjklzxcvbnm,.]+'?)*$"
    xtroke_lookup: "^`X([hspnz]+'?)*$"
    roots: "][qwrtyuopasdfghjklzxcvbnm;,/]*"
    punct: '^\|([QWRTYUOPASDFGHJKLZXCVBNM<>qwrtyuopasdfghjklzxcvbnm,.]+)$'
